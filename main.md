<!-- MathJaX required to read this markdown -->

# 仕様書

## 第一目標

**小学生を主な対象に、アルゴリズム思考力を培うことが出来るサービス**

### 想定年齢層

- 小学三年生～六年生くらい

## 用語集

- アルゴリズム思考力
  - ある問題に対して、それを解決するために問題を細分化して解決方法を導き出す思考力
  - コーディング力とは別物で、既知の知識や処理構造を組み合わせることが主題
- 盤面
  - 任意の正の整数 $H, W$ を用いて「縦 $H$ マス、横 $W$ マスに広がる」と言い表せるようなマスの集合
  - マスは正方形
- 壁
  - NPC の移動を妨げる。
- 石
  - NPC の移動を妨げるが、PC によって破壊できる
- 床
  - NPC の移動を妨げない。
  - 現時点では草の画像で表現される。
- PC
  - ユーザが操作するキャラクター。
  - 現時点ではカーソルとして表現される。
- NPC
  - ユーザには操作できないキャラクター。
  - 現時点では人型の画像で表現される。
  - このキャラクターは、一定の決まりに従って行動を繰り返す。これを NPC 行動ルーチンと呼ぶ。NPC 行動ルーチンを以下に示す。
    - NPCの目前が床であるならば、そこに移動する。
    - そうでないならば、自身の左右マスを確認する。
      - 片方が床で片方が壁か石ならば、床がある方に旋回する。
      - どちらとも床ならば、NPC から見て右へ旋回する。
      - どちらとも壁か石ならば、$180$ 度旋回する。
- 問題
  - 盤面、PC / NPC の初期位置、ゴールの位置、後述するユーザプログラムのコスト上限 の情報を含み、NPC をゴールに導く方法が存在するようなもの。
  - ユーザは NPC をゴールに導くことを目的として行動する。
- ユーザプログラム
  - ユーザが blockly を用いて配置したプログラムのこと。
  - これに従って PC が NPC に先立って行動を開始し、その終了後に NPC が NPC 行動ルーチンに従って行動する。
  - 行動内容にコストが設定されており、問題に設定された上限コストを超えるプログラムは実行のみができない。

---

## 詳細

### パズルゲームの詳細

#### 形式

ユーザの操作内容としては以下の通り。

- PC を操作するユーザプログラムを記述する。
- PC はユーザプログラムの通りに行動し、その終了を受けて NPC が行動開始するので、NPC がゴールにたどり着ければクリア。

#### ゲーム全体の構造

- パズルゲームという形式でかつ繰り返し、条件分岐や変数などを活用できるようにする。
- 問題は幾つかの難易度に軽く分ける。
  1. 複雑な処理構造を必要としない
  2. 繰り返し、条件分岐、変数のいずれかが必要
  3. 繰り返し、条件分岐、変数を複雑に組み合わせる
  4. これは相当余裕があれば実装。再帰などの本格的なアルゴリズムに触れる
- 現在実装している問題の一覧
  1. 複雑な処理構造を必要としないもの
  	PCがブロックを破壊し、NPCのゴールまでの導き方を教えるチュートリアル問題
  2. 繰り返しを必要とするもの
  	一問目のブロック破壊を慣らせると同時に、繰り返しと変数の使い方を教えるチュートリアル問題
  3. ブロックの配置を必要とするもの
  	二問目の繰り返しを慣らせると同時に、ブロックを配置してゴールまで辿り着かせるチュートリアル問題
  4. 条件分岐を必要とするもの
  	ブロック破壊/配置を、条件分岐によって各場面で使わせるチュートリアル問題
  5. パズル問題1
  	ルートを自分で考えさせる中級問題1
  6. パズル問題2
  	ルートを自分で考えさせる中級問題2

#### 将来的に実装したいもの

- **数問解いたあたりで、ユーザが問題を自作できるようなモードを解放する**
  - ユーザが早期に離れるのを防止したい
- もっとギミックを増やす
  - まだ単調すぎる

---

### プログラムの詳細

#### 画面仕様

![初期状態](https://raw.githubusercontent.com/WhiteF326/0818_newDev/master/images/screenshot_1.png)
↑が盤面初期状態の画面。

- 左上
  - 盤面そのもの。
    - 灰色のチップは壁を表現する。
    - 茶色のチップは石を表現する。
    - 緑色のチップは床を表現する。
- 右上
  - 問題がもつ情報のうち、ユーザプログラムの現在のコスト、コスト上限を表示。
  - ユーザプログラムを実行するボタン、問題そのものをやり直すボタンを配置。
- 下
  - ユーザプログラムを記述する。

![プログラミング中](https://raw.githubusercontent.com/WhiteF326/0818_newDev/master/images/screenshot_2.png)

- 下部の blockly によって実装されたブロックプログラミング環境で、PC を動かすためのプログラムを実装する。

![実行中](https://raw.githubusercontent.com/WhiteF326/0818_newDev/master/images/screenshot_3.png)

- 開始ボタンを押すとユーザプログラムが実行され、カーソルが移動したり石が配置、消去される。
- その後、NPC が移動を開始する。

<video controls>
  <source src="https://raw.githubusercontent.com/WhiteF326/0818_newDev/master/images/playscene.mp4" type="video/mp4">
</video>

#### その他

- 動作環境
  - Chrome
  - Edge
- プログラミングに使用した言語
  - HTML + CSS
  - JavaScript
- サーバ ランタイム
  - [deno](https://deno.land/)
- GitHub
  - https://github.com/WhiteF326/0818_newDev
- その他、使用したライブラリ
  - ブロックプログラミング環境 [blockly](https://developers.google.com/blockly/)
  - JavaScript 整形ツール [ESLint](https://eslint.org/)